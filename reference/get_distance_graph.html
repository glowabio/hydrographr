<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get the distance in meters between stream segments along a network graph — get_distance_graph • hydrographr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get the distance in meters between stream segments along a network graph — get_distance_graph"><meta name="description" content='Given a set of input sub-catchment IDs, the function will
calculate the network distance in meters between all input pairs.
Alternatively, only the number of stream segments (sub-catchment) along the
paths are reported. Note that the stream segment and sub-catchment
IDs are identical, and for consistency, we use the term "subc_id".
See the example code under "Note" that explains how to use standard igraph
functions to obtain the actual stream segment IDs along the path. The
function read_geopackage() can be used to create the input
network graph, and the function get_catchment_graph() can be
used to subset a network graph. Note that graph-based function includes also
the entire length of the "from" and "to" stream segment, opposed to the
get_distance() which, depending on the snapping method,
includes only the part of the "from" and "to" segement where the points are
located, resulting in minor differences.'><meta property="og:description" content='Given a set of input sub-catchment IDs, the function will
calculate the network distance in meters between all input pairs.
Alternatively, only the number of stream segments (sub-catchment) along the
paths are reported. Note that the stream segment and sub-catchment
IDs are identical, and for consistency, we use the term "subc_id".
See the example code under "Note" that explains how to use standard igraph
functions to obtain the actual stream segment IDs along the path. The
function read_geopackage() can be used to create the input
network graph, and the function get_catchment_graph() can be
used to subset a network graph. Note that graph-based function includes also
the entire length of the "from" and "to" stream segment, opposed to the
get_distance() which, depending on the snapping method,
includes only the part of the "from" and "to" segement where the points are
located, resulting in minor differences.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydrographr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmark.html">Function benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_Danube.html">Case study - Danube basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_germany.html">Case study - Germany</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_lakes.html">Case study - Lake Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/example_other_stream_networks.html">Usage of hydrographr with other stream networks</a></li>
    <li><a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a></li>
    <li><a class="dropdown-item" href="../articles/macos_system_setup.html">Setting up the package requirements on MacOS</a></li>
    <li><a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get the distance in meters between stream segments along a network graph</h1>
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/R/get_distance_graph.R" class="external-link"><code>R/get_distance_graph.R</code></a></small>
      <div class="d-none name"><code>get_distance_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a set of input sub-catchment IDs, the function will
calculate the network distance in meters between all input pairs.
Alternatively, only the number of stream segments (sub-catchment) along the
paths are reported. Note that the stream segment and sub-catchment
IDs are identical, and for consistency, we use the term "subc_id".</p>
<p>See the example code under "Note" that explains how to use standard igraph
functions to obtain the actual stream segment IDs along the path. The
function <code><a href="read_geopackage.html">read_geopackage()</a></code> can be used to create the input
network graph, and the function <code><a href="get_catchment_graph.html">get_catchment_graph()</a></code> can be
used to subset a network graph. Note that graph-based function includes also
the entire length of the "from" and "to" stream segment, opposed to the
<code><a href="get_distance.html">get_distance()</a></code> which, depending on the snapping method,
includes only the part of the "from" and "to" segement where the points are
located, resulting in minor differences.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_distance_graph</span><span class="op">(</span></span>
<span>  <span class="va">g</span>,</span>
<span>  subc_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"length"</span>,</span>
<span>  distance_m <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">1500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>igraph object. A directed graph.</p></dd>


<dt id="arg-subc-id">subc_id<a class="anchor" aria-label="anchor" href="#arg-subc-id"></a></dt>
<dd><p>numeric. Vector of a single or multiple IDs,
e.g (c(ID1, ID2, ID3, ...). The sub-catchment (equivalent to stream segment)
IDs for calculating the distances. Note that you can browse the entire
network online at <a href="https://geo.igb-berlin.de/maps/351/view" class="external-link">https://geo.igb-berlin.de/maps/351/view</a> and to the
left hand side, select the "Stream segment ID" layer and click on the map
to get the ID.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>character. Specify the attribute / column name in the graph
object that should be cumulated along the network path. Default is "length"
to be used with the Hydrography90m dataset. Not needed when
using "distance_m = FALSE".</p></dd>


<dt id="arg-distance-m">distance_m<a class="anchor" aria-label="anchor" href="#arg-distance-m"></a></dt>
<dd><p>logical. If TRUE, and in case of the Hydrography90m dataset,
the length (in meters) of each network segment along the path will be
cumulated and the total length between all pairs will be reported in
data.table. If FALSE, only the number of segments that are traversed
through will be reported in the output matrix. If the subc_ids of the actual
path is needed, please see the example code under "Note". Default is TRUE.</p></dd>


<dt id="arg-max-size">max_size<a class="anchor" aria-label="anchor" href="#arg-max-size"></a></dt>
<dd><p>numeric. Specifies the maximum size of the data passed to the
parallel back-end in MB. Default is 1500 (1.5 GB). Consider a higher value
for large study areas (more than one 20°x20° tile). Optional.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.table that reports either the distance or the number of
segments between sub_ids.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>For getting the actual IDs of the path between two sub-catchments,
you can use the igraph function "all_shortest_paths":</p>
<p>Specify the subc_ids:</p>
<p>from_subc_id = 513866854</p>
<p>to_subc_id = 513867238</p>
<p>subc_path &lt;- all_shortest_paths(graph = my_graph,
from = as.character(from_subc_id),
to = as.character(to_subc_id),
mode = "all")</p>
<p>Extract only the subc_ids from the output:</p>
<p>subc_path &lt;- as.numeric(as_ids(subc_path$res[1]))</p>
<p>We can then attach environmental data to the sub-catchments along the path,
using the functions read_geopackage or extract_zonal_statistics</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Csardi G, Nepusz T: The igraph software package for complex network research,
InterJournal, Complex Systems 1695. 2006. <a href="https://igraph.org" class="external-link">https://igraph.org</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="read_geopackage.html">read_geopackage()</a></code> to create a network graph.</p></li>
<li><p><code><a href="get_catchment_graph.html">get_catchment_graph()</a></code> to subset a network graph.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sami Domisch</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Download test data into the temporary R folder</span></span>
<span><span class="co"># or define a different directory</span></span>
<span></span>
<span><span class="va">my_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="download_test_data.html">download_test_data</a></span><span class="op">(</span><span class="va">my_directory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load stream network as a graph</span></span>
<span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                                         <span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                                         <span class="st">"/order_vect_59.gpkg"</span><span class="op">)</span>,</span>
<span>                           import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assume we have some point data in the following sub-catchment IDs:</span></span>
<span><span class="va">subc_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"513863746"</span>, <span class="st">"513866851"</span>, <span class="st">"513867238"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ... if you have some point data, use the extract_ids() function:</span></span>
<span><span class="co"># (the coordinates correspond to the same three subc_ids)</span></span>
<span><span class="va">my_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8.885996642821286</span>,</span>
<span>                                      <span class="fl">8.873352770456831</span>,</span>
<span>                                      <span class="fl">8.898060225276105</span><span class="op">)</span>,</span>
<span>                        latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42.26533822791161</span>,</span>
<span>                                     <span class="fl">42.26307509726402</span>,</span>
<span>                                     <span class="fl">42.25513157316764</span><span class="op">)</span>,</span>
<span>                        occurrence_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the path of the sub-catchment raster</span></span>
<span><span class="va">subc_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                      <span class="st">"/hydrography90m_test_data/subcatchment_1264942.tif"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Extract the sub-catchment IDs for the points:</span></span>
<span><span class="va">my_points_subc_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_ids.html">extract_ids</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">my_points</span>,</span>
<span>                                 lon <span class="op">=</span> <span class="st">"longitude"</span>,</span>
<span>                                 lat <span class="op">=</span> <span class="st">"latitude"</span>,</span>
<span>                                 id <span class="op">=</span> <span class="st">"occurrence_id"</span>,</span>
<span>                                 subc_layer <span class="op">=</span> <span class="va">subc_raster</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Get a vector of the sub-catchment IDs:</span></span>
<span><span class="va">subc_id</span> <span class="op">&lt;-</span> <span class="va">my_points_subc_id</span><span class="op">$</span><span class="va">subcatchment_id</span></span>
<span></span>
<span><span class="co"># Get the network distance (in meters) between all input pairs:</span></span>
<span><span class="va">subc_distances</span> <span class="op">&lt;-</span> <span class="fu">get_distance_graph</span><span class="op">(</span><span class="va">my_graph</span>,</span>
<span>                                     subc_id <span class="op">=</span> <span class="va">subc_id</span>,</span>
<span>                                     variable <span class="op">=</span> <span class="st">"length"</span>,</span>
<span>                                     distance_m <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">subc_distances</span></span>
<span></span>
<span><span class="co"># Get the number of stream segments that are along the network path:</span></span>
<span><span class="va">number_segments</span> <span class="op">&lt;-</span> <span class="fu">get_distance_graph</span><span class="op">(</span><span class="va">my_graph</span>,</span>
<span>                                      subc_id <span class="op">=</span> <span class="va">subc_id</span>,</span>
<span>                                      variable <span class="op">=</span> <span class="st">"length"</span>,</span>
<span>                                      distance_m <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">number_segments</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marlene Schürz, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Merret Buurman, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

