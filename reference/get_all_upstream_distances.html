<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get all upstream distances for all subc_id — get_all_upstream_distances • hydrographr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get all upstream distances for all subc_id — get_all_upstream_distances"><meta name="description" content='Calculates the upstream distance from each subc_id to all
upstream subc_id. The output can be directly used in spatial prioritization
analyses for e.g. Marxan, Gurobi etc. to specify the longitudinal connectivity.
Note that the stream segment and sub-catchment IDs are identical, and for
consistency, we use the term "subc_id".
Note that the distance can be extremely long and for the subsequent spatial
prioritization analyses you might want to consider setting a cap at a
certain distance.'><meta property="og:description" content='Calculates the upstream distance from each subc_id to all
upstream subc_id. The output can be directly used in spatial prioritization
analyses for e.g. Marxan, Gurobi etc. to specify the longitudinal connectivity.
Note that the stream segment and sub-catchment IDs are identical, and for
consistency, we use the term "subc_id".
Note that the distance can be extremely long and for the subsequent spatial
prioritization analyses you might want to consider setting a cap at a
certain distance.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydrographr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmark.html">Function benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_germany.html">Case study - Germany</a></li>
    <li><a class="dropdown-item" href="../articles/example_other_stream_networks.html">Usage of hydrographr with other stream networks</a></li>
    <li><a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a></li>
    <li><a class="dropdown-item" href="../articles/macos_system_setup.html">Setting up the package requirements on MacOS</a></li>
    <li><a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get all upstream distances for all subc_id</h1>
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/R/get_all_upstream_distances.R" class="external-link"><code>R/get_all_upstream_distances.R</code></a></small>
      <div class="d-none name"><code>get_all_upstream_distances.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the upstream distance from each subc_id to all
upstream subc_id. The output can be directly used in spatial prioritization
analyses for e.g. Marxan, Gurobi etc. to specify the longitudinal connectivity.
Note that the stream segment and sub-catchment IDs are identical, and for
consistency, we use the term "subc_id".</p>
<p>Note that the distance can be extremely long and for the subsequent spatial
prioritization analyses you might want to consider setting a cap at a
certain distance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_all_upstream_distances</span><span class="op">(</span>network_table <span class="op">=</span> <span class="va">network_table</span>, n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-network-table">network_table<a class="anchor" aria-label="anchor" href="#arg-network-table"></a></dt>
<dd><p>A data.table that includes the columns
<code>c(stream, next_stream, out_dist</code>, the latter specifying the distance
to the outlet (which is included in the Hydrography90m vector attribute table).</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>numeric. Number of cores used for parallelisation
in the case of multiple stream segments / s. Default is 1.
Currently, the parallelisation process requires copying the data to each
core. In case the graph is very large, and many segments are
used as an input, setting n_cores to a higher value can speed up the
computation. This comes however at the cost of possible RAM limitations
and even slower processing since the large data will be copied to each core.
Hence consider testing with n_cores = 1 first. Optional.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.table that reports the distance (in meters) from
each subc_id to all upstream subc_ids.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Currently the attributes are not provided for the  (the selected
subc_id segment). If the attributes are also needed for the outlet subc_id,
then the next downstream sub_id can be selected (enlarge the study area)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Csardi G, Nepusz T: The igraph software package for complex network research,
InterJournal, Complex Systems 1695. 2006. <a href="https://igraph.org" class="external-link">https://igraph.org</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_geopackage.html">read_geopackage()</a></code> and <code><a href="get_catchment_graph.html">get_catchment_graph()</a></code> to
create a network graph. Alternatively, see
<code><a href="get_segment_neighbours.html">get_segment_neighbours()</a></code> to obtain the upstream variables for
a specified neighbourhood, or <code><a href="get_upstream_variable.html">get_upstream_variable()</a></code> to
aggregate a set of variables across the upstream catchment.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sami Domisch</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Download test data into the temporary R folder</span></span>
<span><span class="co"># or define a different directory</span></span>
<span><span class="va">my_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="download_test_data.html">download_test_data</a></span><span class="op">(</span><span class="va">my_directory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load stream network as a graph</span></span>
<span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                                         <span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                                         <span class="st">"/order_vect_59.gpkg"</span><span class="op">)</span>,</span>
<span>                           import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pick a random subc_id</span></span>
<span><span class="va">subc_id</span> <span class="op">=</span> <span class="st">"513867228"</span></span>
<span><span class="co"># Get the upstream catchment as a data.table</span></span>
<span><span class="va">network_table</span> <span class="op">&lt;-</span> <span class="fu">hydrographr</span><span class="fu">::</span><span class="fu"><a href="get_catchment_graph.html">get_catchment_graph</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span> ,</span>
<span>                                                  subc_id <span class="op">=</span> <span class="va">subc_id</span>,</span>
<span>                                                  mode <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>                                                  use_outlet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                  as_graph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                  n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Condense the table supplied to the function to save RAM</span></span>
<span><span class="va">keep_these</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stream"</span>, <span class="st">"next_stream"</span>, <span class="st">"out_dist"</span><span class="op">)</span></span>
<span><span class="va">network_table</span> <span class="op">&lt;-</span> <span class="va">network_table</span><span class="op">[</span>, <span class="va">..keep_these</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Change to integers</span></span>
<span><span class="va">network_table</span><span class="op">$</span><span class="va">stream</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">network_table</span><span class="op">$</span><span class="va">stream</span><span class="op">)</span></span>
<span><span class="va">network_table</span><span class="op">$</span><span class="va">next_stream</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">network_table</span><span class="op">$</span><span class="va">next_stream</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Calculate the network distance (in meter) from each subc_id to</span></span>
<span><span class="co">## all upstream subc_id using four CPUs for the parallelization</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">get_all_upstream_distances</span><span class="op">(</span>network_table <span class="op">=</span> <span class="va">network_table</span>,</span>
<span>                                      n_cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marlene Schürz, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Merret Buurman, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

