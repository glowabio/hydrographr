<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate zonal statistics — extract_zonal_stat • hydrographr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate zonal statistics — extract_zonal_stat"><meta name="description" content="Calculate zonal statistics based on one or more environmental
variable raster .tif layers. This function aggregates data to
12 summary statistics (mean, min, max, range, ...) for selected or all
sub-catchments of the input file. The sub-catchment raster (.tif) input
file is read directly from disk. The output is a data.table which is loaded
into R. This function can also be used for any zonal statistic calculation
by specifying the raster layer zones in the subc_layer parameter and
optionally, also the target zone IDs in the subc_id parameter."><meta property="og:description" content="Calculate zonal statistics based on one or more environmental
variable raster .tif layers. This function aggregates data to
12 summary statistics (mean, min, max, range, ...) for selected or all
sub-catchments of the input file. The sub-catchment raster (.tif) input
file is read directly from disk. The output is a data.table which is loaded
into R. This function can also be used for any zonal statistic calculation
by specifying the raster layer zones in the subc_layer parameter and
optionally, also the target zone IDs in the subc_id parameter."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydrographr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmark.html">Function benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_germany.html">Case study - Germany</a></li>
    <li><a class="dropdown-item" href="../articles/example_other_stream_networks.html">Usage of hydrographr with other stream networks</a></li>
    <li><a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a></li>
    <li><a class="dropdown-item" href="../articles/macos_system_setup.html">Setting up the package requirements on MacOS</a></li>
    <li><a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate zonal statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/R/extract_zonal_stat.R" class="external-link"><code>R/extract_zonal_stat.R</code></a></small>
      <div class="d-none name"><code>extract_zonal_stat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate zonal statistics based on one or more environmental
variable raster .tif layers. This function aggregates data to
12 summary statistics (mean, min, max, range, ...) for selected or all
sub-catchments of the input file. The sub-catchment raster (.tif) input
file is read directly from disk. The output is a data.table which is loaded
into R. This function can also be used for any zonal statistic calculation
by specifying the raster layer zones in the subc_layer parameter and
optionally, also the target zone IDs in the subc_id parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_zonal_stat</span><span class="op">(</span></span>
<span>  <span class="va">data_dir</span>,</span>
<span>  <span class="va">subc_id</span>,</span>
<span>  <span class="va">subc_layer</span>,</span>
<span>  <span class="va">var_layer</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-dir">data_dir<a class="anchor" aria-label="anchor" href="#arg-data-dir"></a></dt>
<dd><p>character. Path to the directory containing all input data.</p></dd>


<dt id="arg-subc-id">subc_id<a class="anchor" aria-label="anchor" href="#arg-subc-id"></a></dt>
<dd><p>Vector of sub-catchment IDs or "all".
If "all", zonal statistics are calculated for all sub-catchments
of the given sub-catchment raster layer. A vector of the sub-catchment IDs
can be acquired from the extract_ids() function, and by sub-setting
the resulting data.frame.</p></dd>


<dt id="arg-subc-layer">subc_layer<a class="anchor" aria-label="anchor" href="#arg-subc-layer"></a></dt>
<dd><p>character. Full path to the sub-catchment ID .tif layer.</p></dd>


<dt id="arg-var-layer">var_layer<a class="anchor" aria-label="anchor" href="#arg-var-layer"></a></dt>
<dd><p>character vector of variable raster layers on disk,
e.g. "slope_grad_dw_cel_h00v00.tif". Note that the variable name appears in
the output table columns (e.g. slope_grad_dw_cel_mean). To speed up the
processing, the selected variable raster layers can be cropped to the extent
of the sub-catchment layer, e.g. with <code><a href="crop_to_extent.html">crop_to_extent()</a></code>.</p></dd>


<dt id="arg-out-dir">out_dir<a class="anchor" aria-label="anchor" href="#arg-out-dir"></a></dt>
<dd><p>character. The directory where the output will be stored.
If the out_dir and file_name are specified, the output table will be stored
as a .csv file in this location. If they are NULL, the output is only
loaded in R and not stored on disk.</p></dd>


<dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>character. Name of the .csv file where the output table
will be stored. out_dir should also be specified for this purpose.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>numeric. Number of cores used for parallelization, in case
multiple .tif files are provided to var_layer. Default is 1.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>logical. If FALSE, the standard output will be printed.
Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a table with</p><ul><li><p>sub-catchment ID (subc_id)</p></li>
<li><p>number of cells with a value (data_cells)</p></li>
<li><p>number of cells with a NoData value (nodata_cells)</p></li>
<li><p>minimum value (min)</p></li>
<li><p>maximum value (max)</p></li>
<li><p>value range (range)</p></li>
<li><p>arithmetic mean (mean)</p></li>
<li><p>arithmetic mean of the absolute values (mean_abs)</p></li>
<li><p>standard deviation (sd)</p></li>
<li><p>variance (var)</p></li>
<li><p>coefficient of variation (cv)</p></li>
<li><p>sum (sum)</p></li>
<li><p>sum of the absolute values (sum_abs).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://grass.osgeo.org/grass82/manuals/r.univar.html" class="external-link">https://grass.osgeo.org/grass82/manuals/r.univar.html</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="report_no_data.html">report_no_data()</a></code> to check the defined NoData value.</p></li>
<li><p><code><a href="set_no_data.html">set_no_data()</a></code> to define a NoData value.</p></li>
<li><p><code><a href="crop_to_extent.html">crop_to_extent()</a></code> to crop the data to the same extent as the
sub-catchments (subc_layer).</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Afroditi Grigoropoulou, Jaime Garcia Marquez, Marlene Schürz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Download test data into the temporary R folder</span></span>
<span><span class="co"># or define a different directory</span></span>
<span><span class="va">my_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="download_test_data.html">download_test_data</a></span><span class="op">(</span><span class="va">my_directory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define full path to the sub-catchment ID .tif layer</span></span>
<span><span class="va">subc_raster</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>, <span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                       <span class="st">"/subcatchment_1264942.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the directory where the output will be stored</span></span>
<span><span class="va">output_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>, <span class="st">"/hydrography90m_test_data/output"</span><span class="op">)</span></span>
<span><span class="co"># Create output folder if it doesn't exist</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">output_folder</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">output_folder</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the zonal statistics for all sub-catchments for two variables</span></span>
<span><span class="va">stat</span> <span class="op">&lt;-</span> <span class="fu">extract_zonal_stat</span><span class="op">(</span>data_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                                             <span class="st">"/hydrography90m_test_data"</span><span class="op">)</span>,</span>
<span>                           subc_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">513837216</span>, <span class="fl">513841103</span>,</span>
<span>                                       <span class="fl">513850467</span>, <span class="fl">513868394</span>,</span>
<span>                                       <span class="fl">513870312</span><span class="op">)</span>,</span>
<span>                           subc_layer <span class="op">=</span> <span class="va">subc_raster</span>,</span>
<span>                           var_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spi_1264942.tif"</span>,</span>
<span>                                         <span class="st">"sti_1264942.tif"</span><span class="op">)</span>,</span>
<span>                           out_dir <span class="op">=</span> <span class="va">output_folder</span>,</span>
<span>                           file_name <span class="op">=</span> <span class="st">"zonal_statistics.csv"</span>,</span>
<span>                           n_cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Show output table</span></span>
<span><span class="va">stat</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marlene Schürz, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Merret Buurman, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

