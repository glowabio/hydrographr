<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get catchment from stream network graph — get_catchment_graph • hydrographr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get catchment from stream network graph — get_catchment_graph"><meta name="description" content='Subset the stream network graph by extracting the upstream,
downstream or entire catchment, for one or multiple stream segments. The
function will return either one or more data.tables or graph objects for
each input stream segment. Note that the stream segment and sub-catchment
IDs are identical, and for consistency, we use the term "subc_id".
By switching the mode to either "in", "out" or "all", only the upstream,
downstream or all connected segments will be returned, respectively. The
function read_geopackage() can be used to create the input network graph.'><meta property="og:description" content='Subset the stream network graph by extracting the upstream,
downstream or entire catchment, for one or multiple stream segments. The
function will return either one or more data.tables or graph objects for
each input stream segment. Note that the stream segment and sub-catchment
IDs are identical, and for consistency, we use the term "subc_id".
By switching the mode to either "in", "out" or "all", only the upstream,
downstream or all connected segments will be returned, respectively. The
function read_geopackage() can be used to create the input network graph.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydrographr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmark.html">Function benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_Danube.html">Case study - Danube basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_germany.html">Case study - Germany</a></li>
    <li><a class="dropdown-item" href="../articles/example_other_stream_networks.html">Usage of hydrographr with other stream networks</a></li>
    <li><a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a></li>
    <li><a class="dropdown-item" href="../articles/macos_system_setup.html">Setting up the package requirements on MacOS</a></li>
    <li><a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get catchment from stream network graph</h1>
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/R/get_catchment_graph.R" class="external-link"><code>R/get_catchment_graph.R</code></a></small>
      <div class="d-none name"><code>get_catchment_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Subset the stream network graph by extracting the upstream,
downstream or entire catchment, for one or multiple stream segments. The
function will return either one or more data.tables or graph objects for
each input stream segment. Note that the stream segment and sub-catchment
IDs are identical, and for consistency, we use the term "subc_id".</p>
<p>By switching the mode to either "in", "out" or "all", only the upstream,
downstream or all connected segments will be returned, respectively. The
function <code><a href="read_geopackage.html">read_geopackage()</a></code> can be used to create the input network graph.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_catchment_graph</span><span class="op">(</span></span>
<span>  <span class="va">g</span>,</span>
<span>  subc_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_outlet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as_graph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">1500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>igraph object. A directed graph.</p></dd>


<dt id="arg-subc-id">subc_id<a class="anchor" aria-label="anchor" href="#arg-subc-id"></a></dt>
<dd><p>numeric vector of a single or multiple IDs,
e.g (c(ID1, ID2, ID3, ...). The sub-catchment (equivalent to stream segment)
IDs for which to delineate the upstream drainage area.
If empty, then outlets will be used as sub-catchment IDs
(with use_outlet = TRUE). Note that you can browse the entire network online at
<a href="https://geo.igb-berlin.de/maps/351/view" class="external-link">https://geo.igb-berlin.de/maps/351/view</a> and to left hand side, select the
"Stream segment ID"  layer and click on the map to get the ID. Optional.</p></dd>


<dt id="arg-use-outlet">use_outlet<a class="anchor" aria-label="anchor" href="#arg-use-outlet"></a></dt>
<dd><p>logical. If TRUE, the outlets of the given network graph will
be used as additional input subc_ids. Outlets will be identified internally
as those stream segments that do not have any downstream connected segment.
Default is FALSE.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>character. One of "in", "out" or "all". "in" returns the
upstream catchment, "out" returns the downstream catchment (all catchments
that are reachable from the given input segment), and "all" returns both.</p></dd>


<dt id="arg-as-graph">as_graph<a class="anchor" aria-label="anchor" href="#arg-as-graph"></a></dt>
<dd><p>logical. If TRUE, the output will be a new graph or a list
of new graphs with the original attributes. If FALSE, the output  will be a
new data.table or a list of data.tables. List objects are named after the
subc_ids. Default is FALSE.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>numeric. Number of cores used for parallelisation
in the case of multiple stream segments / s. Default is 1.
Currently, the parallelisation process requires copying the data to each
core. In case the graph is very large, and many segments are
used as an input, setting n_cores to a higher value can speed up the
computation. This comes however at the cost of possible RAM limitations
and even slower processing since the large data will be copied to each core.
Hence consider testing with n_cores = 1 first. Optional.</p></dd>


<dt id="arg-max-size">max_size<a class="anchor" aria-label="anchor" href="#arg-max-size"></a></dt>
<dd><p>numeric. Specifies the maximum size of the data passed to the
parallel back-end in MB. Default is 1500 (1.5 GB). Consider a higher value
for large study areas (more than one 20°x20° tile). Optional.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A graph or data.table that reports all subc_ids.
In case of multiple input segments, the results are stored in a list.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Currently the attributes are not provided for the  (the selected
subc_id segment). If the attributes are also needed for the outlet subc_id,
then the next downstream sub_id can be selected (enlarge the study area)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Csardi G, Nepusz T: The igraph software package for complex network research,
InterJournal, Complex Systems 1695. 2006. <a href="https://igraph.org" class="external-link">https://igraph.org</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_geopackage.html">read_geopackage()</a></code> to create a network graph.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sami Domisch</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Download test data into the temporary R folder</span></span>
<span><span class="co"># or define a different directory</span></span>
<span><span class="va">my_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="download_test_data.html">download_test_data</a></span><span class="op">(</span><span class="va">my_directory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load stream network as a graph</span></span>
<span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                                         <span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                                         <span class="st">"/order_vect_59.gpkg"</span><span class="op">)</span>,</span>
<span>                           import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pick a random subc_id</span></span>
<span><span class="va">subc_id</span> <span class="op">=</span> <span class="st">"513855877"</span></span>
<span><span class="co"># Get the upstream catchment as a graph</span></span>
<span><span class="va">g_up</span> <span class="op">&lt;-</span> <span class="fu">get_catchment_graph</span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>, subc_id <span class="op">=</span> <span class="va">subc_id</span>, mode <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>                            use_outlet <span class="op">=</span> <span class="cn">FALSE</span>, as_graph <span class="op">=</span> <span class="cn">TRUE</span>, n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the downstream segments as a data.table,</span></span>
<span><span class="va">g_down</span> <span class="op">&lt;-</span> <span class="fu">get_catchment_graph</span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>, subc_id <span class="op">=</span> <span class="va">subc_id</span>, mode <span class="op">=</span> <span class="st">"out"</span>,</span>
<span>                              use_outlet <span class="op">=</span> <span class="cn">FALSE</span>, as_graph <span class="op">=</span> <span class="cn">FALSE</span>, n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the catchments of all outlets in the study area as a graph</span></span>
<span><span class="va">g_all</span> <span class="op">&lt;-</span> <span class="fu">get_catchment_graph</span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>, mode <span class="op">=</span> <span class="st">"in"</span>, use_outlet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             as_graph <span class="op">=</span> <span class="cn">TRUE</span>, n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marlene Schürz, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Merret Buurman, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

