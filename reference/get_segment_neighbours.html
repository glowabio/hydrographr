<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='For each segment, reports those upstream, downstream, or up-and
downstream segments that are connected to one or multiple input
segments within a specified neighbour order, with the option to
summarize attributes across these segments. Note that the stream
segment and sub-catchment IDs are identical, and for consistency,
we use the term "subc_id".
This function can also be used to create the connectivity table
for Marxan by using var_layer="length" and attach_only=TRUE.
The resulting table reports the connectivity from each segment,
along with the stream length for all connected segments.'><title>Get stream segment neighbours — get_segment_neighbours • hydrographr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get stream segment neighbours — get_segment_neighbours"><meta property="og:description" content='For each segment, reports those upstream, downstream, or up-and
downstream segments that are connected to one or multiple input
segments within a specified neighbour order, with the option to
summarize attributes across these segments. Note that the stream
segment and sub-catchment IDs are identical, and for consistency,
we use the term "subc_id".
This function can also be used to create the connectivity table
for Marxan by using var_layer="length" and attach_only=TRUE.
The resulting table reports the connectivity from each segment,
along with the stream length for all connected segments.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.14</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/hydrographr.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a>
    <a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a>
    <a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a>
    <a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get stream segment neighbours</h1>
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/R/get_segment_neighbours.R" class="external-link"><code>R/get_segment_neighbours.R</code></a></small>
      <div class="d-none name"><code>get_segment_neighbours.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For each segment, reports those upstream, downstream, or up-and
downstream segments that are connected to one or multiple input
segments within a specified neighbour order, with the option to
summarize attributes across these segments. Note that the stream
segment and sub-catchment IDs are identical, and for consistency,
we use the term "subc_id".</p>
<p>This function can also be used to create the connectivity table
for Marxan by using var_layer="length" and attach_only=TRUE.
The resulting table reports the connectivity from each segment,
along with the stream length for all connected segments.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_segment_neighbours</span><span class="op">(</span></span>
<span>  <span class="va">g</span>,</span>
<span>  subc_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_layer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  attach_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">1500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>g</dt>
<dd><p>igraph object. A directed graph.</p></dd>


<dt>subc_id</dt>
<dd><p>numeric vector of the input sub-catchment IDs
(=stream segment IDs) for which to search the connected segments.</p></dd>


<dt>var_layer</dt>
<dd><p>character vector. One or more attributes (variable layers)
of the input graph that should be reported for each output segment_id
("to_stream"). Optional. Default is NULL.</p></dd>


<dt>stat</dt>
<dd><p>one of the functions mean, median, min, max, sd (without quotes).
Aggregates (or summarizes) the variables for the neighbourhood of each input
segment ("stream", e.g., the average land cover in the next five upstream
segments or sub-catchments). Default is NULL.</p></dd>


<dt>attach_only</dt>
<dd><p>logical. If TRUE, the selected variables will be only
attached to each segment without any further aggregation. Default is FALSE.</p></dd>


<dt>order</dt>
<dd><p>numeric. The neighbouring order as in igraph::ego.
Order = 1 would be immediate neighbours of the input sub-catchment IDs,
order = 2 would be the order 1 plus the immediate neighbours of
those sub-catchment IDs in order 1, and so on.</p></dd>


<dt>mode</dt>
<dd><p>character. One of "in", "out", or "all". "in" returns only
upstream neighbouring segments, "out" returns only the downstream segments,
and "all" returns both.</p></dd>


<dt>n_cores</dt>
<dd><p>numeric. Number of cores used for parallelization
in the case of multiple stream segments / outlets. Default is 1.
Currently, the parallelization process requires copying the data to each
core. In case the graph is very large, and many segments are
used as an input, setting n_cores to a higher value can speed up the
computation. This comes however at the cost of possible RAM limitations
and even slower processing since the large data will be copied to each core.
Hence consider testing with n_cores = 1 first. Optional.</p></dd>


<dt>max_size</dt>
<dd><p>numeric. Specifies the maximum size of the data passed to the
parallel back-end in MB. Default is 1500 (1.5 GB). Consider a higher value
for large study areas (more than one 20°x20° tile). Optional.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Csardi G, Nepusz T: The igraph software package for complex network research,
InterJournal, Complex Systems 1695. 2006. <a href="https://igraph.org" class="external-link">https://igraph.org</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sami Domisch</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Download test data into the temporary R folder</span></span>
<span><span class="co"># or define a different directory</span></span>
<span><span class="va">my_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="download_test_data.html">download_test_data</a></span><span class="op">(</span><span class="va">my_directory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the stream network as graph</span></span>
<span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                                         <span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                                         <span class="st">"/order_vect_59.gpkg"</span><span class="op">)</span>,</span>
<span>                            import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the upstream segment neighbours in the 5th order</span></span>
<span><span class="co"># and report the length and source elevation</span></span>
<span><span class="co"># for the neighbours of each input segment</span></span>
<span><span class="fu">get_segment_neighbours</span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>, subc_id <span class="op">=</span> <span class="va">subc_id</span>,</span>
<span>                       order <span class="op">=</span> <span class="fl">5</span>, mode <span class="op">=</span> <span class="st">"in"</span>, n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       var_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length"</span>, <span class="st">"source_elev"</span><span class="op">)</span>,</span>
<span>                       attach_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the downstream segment neighbours in the 5th order</span></span>
<span><span class="co"># and calculate the median length and source elevation</span></span>
<span><span class="co"># across the neighbours of each input segment</span></span>
<span><span class="fu">get_segment_neighbours</span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>, subc_id <span class="op">=</span> <span class="va">subc_id</span>,</span>
<span>                       order <span class="op">=</span> <span class="fl">2</span>, mode <span class="op">=</span><span class="st">"out"</span>, n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       var_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length"</span>, <span class="st">"source_elev"</span><span class="op">)</span>,</span>
<span>                       stat <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the up-and downstream segment neighbours in the 5th order</span></span>
<span><span class="co"># and report the median length and source elevation</span></span>
<span><span class="co"># for the neighbours of each input segment</span></span>
<span><span class="fu">get_segment_neighbours</span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>, subc_id <span class="op">=</span> <span class="va">subc_id</span>, order <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       mode <span class="op">=</span> <span class="st">"all"</span>, n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       var_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length"</span>, <span class="st">"source_elev"</span><span class="op">)</span>,</span>
<span>                       stat <span class="op">=</span> <span class="va">mean</span>, attach_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maria Üblacker, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

