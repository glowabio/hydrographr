<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Subset a basin or catchment into up to nine smaller sub-basins following the
Pfafstetter basin delineation scheme. The functions takes a network graph as
the input and splits it into smaller sub-basins following a
hierarchical topological coding scheme (see Verdin &amp;amp; Verdin (1999) for
details), using the flow accumulation as the basis. The user has to define the
sub-catchment (stream segment) ID that serves as the outlet of the basin.
Note that this can be any stream segment that has an upstream catchment.
The input graph can be created with read_geopackage() and
get_catchment_graph()."><title>Get Pfafstetter sub-basins — get_pfafstetter_basins • hydrographr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Pfafstetter sub-basins — get_pfafstetter_basins"><meta property="og:description" content="Subset a basin or catchment into up to nine smaller sub-basins following the
Pfafstetter basin delineation scheme. The functions takes a network graph as
the input and splits it into smaller sub-basins following a
hierarchical topological coding scheme (see Verdin &amp;amp; Verdin (1999) for
details), using the flow accumulation as the basis. The user has to define the
sub-catchment (stream segment) ID that serves as the outlet of the basin.
Note that this can be any stream segment that has an upstream catchment.
The input graph can be created with read_geopackage() and
get_catchment_graph()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.14</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/hydrographr.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/benchmark.html">Function benchmarks</a>
    <a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a>
    <a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a>
    <a class="dropdown-item" href="../articles/case_study_cuba_for_pdf.html">Case study - Cuba</a>
    <a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a>
    <a class="dropdown-item" href="../articles/macos_system_setup.html">Setting up the package requirements on MacOS</a>
    <a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get Pfafstetter sub-basins</h1>
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/R/get_pfafstetter_basins.R" class="external-link"><code>R/get_pfafstetter_basins.R</code></a></small>
      <div class="d-none name"><code>get_pfafstetter_basins.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Subset a basin or catchment into up to nine smaller sub-basins following the
Pfafstetter basin delineation scheme. The functions takes a network graph as
the input and splits it into smaller sub-basins following a
hierarchical topological coding scheme (see Verdin &amp; Verdin (1999) for
details), using the flow accumulation as the basis. The user has to define the
sub-catchment (stream segment) ID that serves as the outlet of the basin.
Note that this can be any stream segment that has an upstream catchment.
The input graph can be created with <code><a href="read_geopackage.html">read_geopackage()</a></code> and
<code><a href="get_catchment_graph.html">get_catchment_graph()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_pfafstetter_basins</span><span class="op">(</span></span>
<span>  <span class="va">g</span>,</span>
<span>  <span class="va">subc_raster</span>,</span>
<span>  <span class="va">out_dir</span>,</span>
<span>  <span class="va">file_name</span>,</span>
<span>  data_table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>g</dt>
<dd><p>igraph object. A directed graph of a basin with one outlet.
The outlet can be any stream / sub-catchment for which the upstream basin
should be split into smaller sub-basins. The input graph can be created with
<code><a href="read_geopackage.html">read_geopackage()</a></code> and <code><a href="get_catchment_graph.html">get_catchment_graph()</a></code>.</p></dd>


<dt>subc_raster</dt>
<dd><p>character. Full path to the sub-catchment raster file of
the basin. Does not need to be cropped / masked to the basin, but the IDs
of the sub-catchments need to match with those in the input graph.</p></dd>


<dt>out_dir</dt>
<dd><p>character. The path of the output directory where the
Pfafstetter raster layer will be written. Only needed when data.table=FALSE.</p></dd>


<dt>file_name</dt>
<dd><p>character. The filename and extension of the Pfafstetter
raster layer (e.g. 'pfafstetter_raster.tif"). Only needed when
data.table=FALSE.</p></dd>


<dt>data_table</dt>
<dd><p>Logical. If TRUE, then the result will be loaded into R
as a 2-column data.table (sub-catchment ID and Pfafstetter code). If FALSE,
the result is loaded as a raster (terra object) in R and written to disk.
Default is FALSE.</p></dd>


<dt>n_cores</dt>
<dd><p>numeric. Number of cores used for parallelisation. Default is
NULL (= detectCores(logical=FALSE)-1). Optional.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Either a data.table, or a raster (terra object) loaded into R. In
case the result is a raster, then a .tif file is written to disk.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>You can use the online map at https://geo.igb-berlin.de/maps/351/view
to identify an ID of a stream segment (use the "Stream segment ID" layer to
the left)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Verdin, K.L. &amp; Verdin, J.P. (1999). A topological system
for delineation and codification of the Earth’s river basins. Journal
of Hydrology, 218(1-2), 1-12. doi:10.1016/s0022-1694(99)00011-6</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_geopackage.html">read_geopackage()</a></code> and <code>get_catchment_graph.()</code> to
create the input graph.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sami Domisch</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Download test data into the temporary R folder</span></span>
<span><span class="co"># or define a different directory</span></span>
<span><span class="va">my_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="download_test_data.html">download_test_data</a></span><span class="op">(</span><span class="va">my_directory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import the stream network as a graph</span></span>
<span><span class="co"># Load stream network as a graph</span></span>
<span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,</span>
<span>                                         <span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                                         <span class="st">"/order_vect_59.gpkg"</span><span class="op">)</span>,</span>
<span>                           import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subset the graph such that it contains only one basin. You can use</span></span>
<span><span class="co"># a random ID, i.e. it does not need to be the real outlet of the basin.</span></span>
<span><span class="va">g_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_catchment_graph.html">get_catchment_graph</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">my_graph</span>,</span>
<span>                         subc_id <span class="op">=</span> <span class="st">"513867227"</span>,</span>
<span>                         outlet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                         mode <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>                         as_graph <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the sub-catchment raster file</span></span>
<span><span class="va">subc_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">my_directory</span>,<span class="st">"/hydrography90m_test_data"</span>,</span>
<span>                     <span class="st">"/subcatchment_1264942.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the output directory</span></span>
<span><span class="va">out_dir</span> <span class="op">&lt;-</span> <span class="va">my_directory</span></span>
<span></span>
<span><span class="co"># Calculate the Pfafstetter sub-basins and write the raster layer to disk (</span></span>
<span><span class="co"># and import into R)</span></span>
<span><span class="va">pfafstetter</span> <span class="op">&lt;-</span> <span class="fu">get_pfafstetter_basins</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_subset</span> ,</span>
<span>                                      subc_raster <span class="op">=</span> <span class="va">subc_raster</span>,</span>
<span>                                      out_dir <span class="op">=</span> <span class="va">out_dir</span>,</span>
<span>                                      file_name <span class="op">=</span> <span class="st">"pfafstetter_raster.tif"</span>,</span>
<span>                                      data_table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                      n_cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maria Üblacker, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

