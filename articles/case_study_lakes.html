<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case study - Lake Analysis • hydrographr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study - Lake Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrographr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hydrographr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/benchmark.html">Function benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_brazil.html">Case study - São Francisco drainage basin</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_cuba.html">Case study - Cuba</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_Danube.html">Case study - Danube Basin (Environment90m)</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_germany.html">Case study - Germany</a></li>
    <li><a class="dropdown-item" href="../articles/case_study_lakes.html">Case study - Lake Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/example_other_stream_networks.html">Usage of hydrographr with other stream networks</a></li>
    <li><a class="dropdown-item" href="../articles/linux_system_setup.html">Setting up the package requirements on Linux</a></li>
    <li><a class="dropdown-item" href="../articles/macos_system_setup.html">Setting up the package requirements on MacOS</a></li>
    <li><a class="dropdown-item" href="../articles/windows_system_setup.html">Setting up the package requirements on Windows</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glowabio/hydrographr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="case_study_lakes_files/kePrint-0.0.1/kePrint.js"></script><link href="case_study_lakes_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Case study - Lake Analysis</h1>
            <h3 data-toc-skip class="subtitle">Integrating lakes into
the processing of spatial and species data for network analyses of
freshwater fish in Germany</h3>
                        <h4 data-toc-skip class="author"></h4>
            
            <h4 data-toc-skip class="date">2025-12-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/glowabio/hydrographr/blob/HEAD/vignettes/case_study_lakes.Rmd" class="external-link"><code>vignettes/case_study_lakes.Rmd</code></a></small>
      <div class="d-none name"><code>case_study_lakes.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The following workflow showcases the functionality of the hydrographr
package to integrate lakes into a stream network and species
distribution analysis. We will use freshwater fish species occurrence
data from the [cite German freshwater fish GBIF database] and HydroLAKES
shape files and integrate them into the Hydrography90m stream network
(Amatulli et al., 2022).</p>
<p>Load required libraries</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glowabio.github.io/hydrographr/" class="external-link">hydrographr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rgbif" class="external-link">rgbif</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tools</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/leafem" class="external-link">leafem</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>Define working directory</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the "data_lakes" directory, where you have downloaded all the data,</span></span>
<span><span class="co"># as the working directory</span></span>
<span><span class="va">wdir</span> <span class="op">&lt;-</span> <span class="st">"my/working/directory/data_lakes"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">wdir</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new folder in the working directory to store all the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="species-data">Species data<a class="anchor" aria-label="anchor" href="#species-data"></a>
</h3>
<p>We first download the occurrence data with coordinates from GBIF</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Once: Download species occurrence data based on the key of the dataset</span></span>
<span><span class="co"># and write out to working directory</span></span>
<span><span class="va">spdata_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rgbif/reference/occ_download_get.html" class="external-link">occ_download_get</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">"0004551-231002084531237"</span>,</span>
<span>                              overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">occ_download_import</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">spdata_all</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/fish_germany_gbif.csv"</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">F</span>, quote <span class="op">=</span> <span class="cn">F</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import and clean the data</span></span>
<span><span class="va">spdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/fish_germany_gbif.csv"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">gbifID</span>, <span class="va">decimalLongitude</span>, <span class="va">decimalLatitude</span>, <span class="va">species</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"longitude"</span> <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>         <span class="st">"latitude"</span> <span class="op">=</span> <span class="st">"decimalLatitude"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">)</span></span></code></pre></div>
<!-- Let´s remove point occurrences without assigned species names from the data table -->
<!-- ```{r, eval = FALSE} -->
<!-- indx <- which(spdata$species == "") -->
<!-- spdata <- spdata[-c(indx),] -->
<!-- ``` -->
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:500px; ">
<table class="table table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gbifID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
longitude
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
latitude
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
year
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
4058501303
</td>
<td style="text-align:right;">
13.2284
</td>
<td style="text-align:right;">
52.5709
</td>
<td style="text-align:left;">
Abramis brama
</td>
<td style="text-align:right;">
2007
</td>
</tr>
<tr>
<td style="text-align:right;">
4058501307
</td>
<td style="text-align:right;">
13.1564
</td>
<td style="text-align:right;">
52.4147
</td>
<td style="text-align:left;">
Abramis brama
</td>
<td style="text-align:right;">
2007
</td>
</tr>
<tr>
<td style="text-align:right;">
4058460309
</td>
<td style="text-align:right;">
13.1861
</td>
<td style="text-align:right;">
52.4576
</td>
<td style="text-align:left;">
Abramis brama
</td>
<td style="text-align:right;">
2007
</td>
</tr>
<tr>
<td style="text-align:right;">
4058501314
</td>
<td style="text-align:right;">
13.1093
</td>
<td style="text-align:right;">
52.4079
</td>
<td style="text-align:left;">
Abramis brama
</td>
<td style="text-align:right;">
2008
</td>
</tr>
<tr>
<td style="text-align:right;">
4058501316
</td>
<td style="text-align:right;">
13.5746
</td>
<td style="text-align:right;">
52.5091
</td>
<td style="text-align:left;">
Abramis brama
</td>
<td style="text-align:right;">
2008
</td>
</tr>
<tr>
<td style="text-align:right;">
4058460317
</td>
<td style="text-align:right;">
13.1177
</td>
<td style="text-align:right;">
52.4017
</td>
<td style="text-align:left;">
Abramis brama
</td>
<td style="text-align:right;">
2008
</td>
</tr>
</tbody>
</table>
</div>
<p>Let’s visualise the species occurrences on the map</p>
<p>Let’s define the extent (bounding box) of the study area (xmin, ymin,
xmax, ymax)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the extent</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">longitude</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">longitude</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define color palette for the different years of record</span></span>
<span><span class="va">factpal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/colorNumeric.html" class="external-link">colorFactor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>, <span class="va">spdata</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create leaflet plot</span></span>
<span><span class="va">spdata_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span><span class="st">'Esri.WorldShadedRelief'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-methods.html" class="external-link">setMaxBounds</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addCircles</a></span><span class="op">(</span>lng <span class="op">=</span> <span class="op">~</span><span class="va">longitude</span>, lat <span class="op">=</span> <span class="op">~</span> <span class="va">latitude</span>, </span>
<span>             color <span class="op">=</span>  <span class="op">~</span><span class="fu">factpal</span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             opacity <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addLegend.html" class="external-link">addLegend</a></span><span class="op">(</span>pal <span class="op">=</span> <span class="va">factpal</span>, values <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Year of record"</span><span class="op">)</span></span>
<span><span class="va">spdata_plot</span></span></code></pre></div>
<p><img src="../reference/figures/germany_map.png" width="800"></p>
</div>
<div class="section level3">
<h3 id="abiotic-variables-data">Abiotic variables data<a class="anchor" aria-label="anchor" href="#abiotic-variables-data"></a>
</h3>
<div class="section level4">
<h4 id="hydrography90m">1. Hydrography90m<a class="anchor" aria-label="anchor" href="#hydrography90m"></a>
</h4>
<p>In order to integrate lakes into the Hydrography90m, we need to
download the following GEO.tiff files (in brackets the variable and
folder name to download): 1. basin files (“basin”) 2. sub-catchment
files (“SUb_catchment) 3. stream network (”segment”) 4. flow
accumulation (“accumulation”) 5. flow direction</p>
<p>First, we identify the tile ID covering our species data. In our case
that are three tiles (h16v02; h18v00; h18v02).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get tile ID for Germany</span></span>
<span><span class="va">tile_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_tile_id.html">get_tile_id</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spdata</span>,</span>
<span>                       lon <span class="op">=</span> <span class="st">"longitude"</span>, </span>
<span>                       lat <span class="op">=</span> <span class="st">"latitude"</span><span class="op">)</span></span></code></pre></div>
<p>Secondly, we select and download all relevant hydrological variables
necessary to intersect lakes and stream network and to delineate lake
catchments.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select the necessary hydrological variables for downloading</span></span>
<span><span class="va">vars_tif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"basin"</span>, <span class="st">"sub_catchment"</span>, <span class="st">"segment"</span>, <span class="st">"accumulation"</span>, <span class="st">"direction"</span><span class="op">)</span></span>
<span><span class="co"># Extend timeout to 1000s to allow uninterrupted downloading</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download the tif.files of the selceted variables</span></span>
<span><span class="fu"><a href="../reference/download_tiles.html">download_tiles</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="va">vars_tif</span>,</span>
<span>               tile_id <span class="op">=</span> <span class="va">tile_id</span>,</span>
<span>               file_format <span class="op">=</span> <span class="st">"tif"</span>,</span>
<span>               download_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that the files have been downloaded to a new folder (i.e.,
“r.watershed”).</p>
<p>Now we can merge the three tile files to obtain the sub-catchment
raster file for the lakes in Germany</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">var</span> <span class="kw">in</span> <span class="va">vars_tif</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Define the folder for the current variable</span></span>
<span>  <span class="va">var_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"data/r.watershed/"</span>, <span class="va">var</span>, <span class="st">"_tiles20d/"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Build path to .tif file names for each variable and tile ids</span></span>
<span>  <span class="va">tile_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">"_"</span>, <span class="va">tile_id</span>, <span class="st">".tif"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># List only the matching .tif files in that folder</span></span>
<span>  <span class="va">tile_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">var_dir</span>, pattern <span class="op">=</span> <span class="st">"\\.tif$"</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">tile_names</span> <span class="op">&lt;-</span> <span class="va">tile_names</span><span class="op">[</span><span class="va">tile_names</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="va">tile_files</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Run the merge function</span></span>
<span>  <span class="fu"><a href="../reference/merge_tiles.html">merge_tiles</a></span><span class="op">(</span></span>
<span>    tile_dir <span class="op">=</span> <span class="va">var_dir</span>,</span>
<span>    tile_names <span class="op">=</span> <span class="va">tile_names</span>,</span>
<span>    out_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span><span class="op">)</span>,</span>
<span>    file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>    read <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    bigtiff <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>It is always good practice to clean disk space by removing the files
and folders we don’t need anymore.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove folder</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"r.watershed"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hydrolakes">2. HydroLAKES<a class="anchor" aria-label="anchor" href="#hydrolakes"></a>
</h4>
<p>For the lake data we use the geo-spatial information from the
HydroLAKES global lake data set and more specifically their lake
polygons. You can either download the lake data stored in shapefiles or
in the geodatabase format, both work with the hydrographr package lake
functions. For more information on the data set you can have a look <a href="https://www.hydrosheds.org/products/hydrolakes" class="external-link">here</a></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extend timeout to 1000s to allow uninterrupted downloading</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download URL of the HydroLAKES shapefile</span></span>
<span><span class="va">hydrolakes_url</span> <span class="op">&lt;-</span> <span class="st">"https://data.hydrosheds.org/file/hydrolakes/HydroLAKES_polys_v10_shp.zip"</span></span>
<span><span class="va">hydrolakes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span>, <span class="st">"HydroLAKES_polys_v10_shp.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://data.hydrosheds.org/file/hydrolakes/HydroLAKES_polys_v10_shp.zip"</span>, destfile <span class="op">=</span> <span class="va">hydrolakes</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">hydrolakes</span>, exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="morphological-spatial-pattern-analysis-mspa-tool-from-guidostoolbox-workbench-gwb">Morphological Spatial Pattern Analysis (MSPA) tool from
GuidosToolbox Workbench (GWB)<a class="anchor" aria-label="anchor" href="#morphological-spatial-pattern-analysis-mspa-tool-from-guidostoolbox-workbench-gwb"></a>
</h3>
<p>We need the open source MSPA analysis tool from GuidosToolbox
Workbench (GWB), in order to identify the intersection points between
our stream network and the lake polygons. You can find more information
about the tool <a href="https://forest.jrc.ec.europa.eu/en/activities/lpa/gwb/" class="external-link">here</a></p>
<div class="section level4">
<h4 id="linux">Linux<a class="anchor" aria-label="anchor" href="#linux"></a>
</h4>
<p>Follow the installation guidelines for your Linux system under <a href="https://gwbdoc.readthedocs.io/en/latest/installation.html" class="external-link">here</a>
or download the generic installer <a href="https://ies-ows.jrc.ec.europa.eu/gtb/GWB/GWB_linux64.run" class="external-link">GWB_linux64.run</a>
to your <code>$HOME</code> account. Open a terminal, make the installer
executable, and run it using the command:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> wget https://ies-ows.jrc.ec.europa.eu/gtb/GWB/GWB_linux64.run</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="ex">$</span> chmod u+x GWB_linux64.run</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="ex">$</span>  ./GWB_linux64.run</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h4>
<p>Windows user need to install the GWB tool to their linux virtual
machine. If you don’t have the linux virtual machine isntalled on your
computer please follow the instructions <a href="https://glowabio.github.io/hydrographr/articles/windows_system_setup.html" class="external-link">here</a>
in order to be able to run the hydrographr R package. Then go to your
linux system, open the terminal and install GuidosToolbox Workbench.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> wget https://ies-ows.jrc.ec.europa.eu/gtb/GWB/GWB_linux64.run</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="ex">$</span> chmod u+x GWB_linux64.run</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="ex">$</span> ./GWB_linux64.run</span></code></pre></div>
<p>Citation: a) GWB (GuidosToolbox Workbench) is available at: <a href="https://forest.jrc.ec.europa.eu/en/activities/lpa/gtb/" class="external-link uri">https://forest.jrc.ec.europa.eu/en/activities/lpa/gtb/</a>
b) The algorithms of this software are based on concepts of mathematical
morphological image analysis described in the publications: Vogt, P.,
Riitters, K. (2017). GuidosToolbox: universal digital image object
analysis. European Journal of Remote Sensing (TEJR), <a href="https://doi.org/10.1080/22797254.2017.1330650" class="external-link uri">https://doi.org/10.1080/22797254.2017.1330650</a> and
Soille, P., Vogt, P. (2009). Morphological Segmentation of Binary
Patterns. Pattern Recognition Letters, <a href="https://doi.org/10.1016/j.patrec.2008.10.015" class="external-link uri">https://doi.org/10.1016/j.patrec.2008.10.015</a></p>
</div>
<div class="section level4">
<h4 id="lake-analysis">Lake analysis<a class="anchor" aria-label="anchor" href="#lake-analysis"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="lake-id-identification">Lake ID identification<a class="anchor" aria-label="anchor" href="#lake-id-identification"></a>
</h3>
<p>Let’s start the lake analysis by identifying all HydroLAKES which are
spatially overlapping with our species data and extract the
corresponding lake IDs. We can do that in two ways:</p>
<ol style="list-style-type: decimal">
<li>Extracting all HydroLAKES IDs within the bounding box of our species
data</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">)</span></span>
<span><span class="co"># let's avoid spaces between species names, since it can lead to names being assigned to different columns and instead connect them via an underscore</span></span>
<span><span class="va">spdata</span><span class="op">$</span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="va">spdata</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/extract_lake_ids.html">extract_lake_ids</a></span><span class="op">(</span><span class="va">spdata</span>,</span>
<span>                 lon <span class="op">=</span> <span class="st">"longitude"</span>,</span>
<span>                 lat <span class="op">=</span> <span class="st">"latitude"</span>,</span>
<span>                 xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">longitude</span><span class="op">)</span>,</span>
<span>                 ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span>,</span>
<span>                 xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">longitude</span><span class="op">)</span>,</span>
<span>                 ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">spdata</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span>,</span>
<span>                 bbox <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 lake_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/HydroLAKES_polys_v10_shp/HydroLAKES_polys_v10.shp"</span><span class="op">)</span>,</span>
<span>                 lake_id_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This option leaves us with 3419 lakes, saved under the text file
“lake_id.txt”. Let’s get more specific and only look at the lakes with
species data within them.</p>
<ol start="2" style="list-style-type: decimal">
<li>Extracting all HydroLAKES IDs of lakes that contain species
data</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_lake_ids.html">extract_lake_ids</a></span><span class="op">(</span><span class="va">spdata</span>,</span>
<span>                 lon <span class="op">=</span> <span class="st">"longitude"</span>,</span>
<span>                 lat <span class="op">=</span> <span class="st">"latitude"</span>,</span>
<span>                 lake_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/HydroLAKES_polys_v10_shp/HydroLAKES_polys_v10.shp"</span><span class="op">)</span>,</span>
<span>                 lake_id_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stream-network-and-lake-intersection">Stream network and lake intersection<a class="anchor" aria-label="anchor" href="#stream-network-and-lake-intersection"></a>
</h3>
<p>Now we can overlay our stream segments with the lake shapefile. In
that way we identify per lake all intersection points between stream
network and lake. Note that this function is running in parallel and
make sure to have enough free CPUs to run the function.</p>
<p>Lets first load in our lake id table which we just created with the 2
step and the <code>extract_lake_ids</code> function and we filter for
two lakes the Rangsdorfer lake (Hylak_id 165245) and the Zeuthener lake
(Hylak_id 165161) in our dataset.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/lake_id.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lake_ids</span> <span class="op">&lt;-</span> <span class="va">lake_ids</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Hylak_id</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">165245</span>, <span class="fl">165161</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">Hylak_id</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Then we can run the <code>get_lake_intersection</code> function. Note
that you need to specify the correct node to your GWB (GuidosToolbox
Workbench) specified in the edge parameter.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_lake_intersection.html">get_lake_intersection</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lake_ids</span>,</span>
<span>                      lakes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/HydroLAKES_polys_v10_shp/HydroLAKES_polys_v10.shp"</span><span class="op">)</span>,</span>
<span>                      lake_id <span class="op">=</span> <span class="st">"Hylak_id"</span>,</span>
<span>                      lake_name <span class="op">=</span> <span class="st">"HydroLAKES_polys_v10"</span>,</span>
<span>                      buffer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      edge <span class="op">=</span> <span class="st">"/home/USER/GWB_version/GWB"</span>,</span>
<span>                      stream <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/segment.tif"</span><span class="op">)</span>,</span>
<span>                      flow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/accumulation.tif"</span><span class="op">)</span>,</span>
<span>                      basins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/basin.tif"</span><span class="op">)</span>,</span>
<span>                      lake_dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span><span class="op">)</span>,</span>
<span>                      n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="lake-catchment-delineation">Lake catchment delineation<a class="anchor" aria-label="anchor" href="#lake-catchment-delineation"></a>
</h3>
<p>Having identified the lake intersection points enables us to
delineate for each intersection point the corresponding upstream
catchment area. Doing this for the lake outlet (i.e the intersection
point with the highest flow accumulation value) gives us the entire lake
catchment area. To do this we apply the <code>get_lake_catchment</code>
function, specifying the outlet with n = 1 (default first row of the
intersection table):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_165245</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/coord_lake_165245.txt"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/get_lake_catchment.html">get_lake_catchment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lake_165245</span>,</span>
<span>                               direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/direction.tif"</span><span class="op">)</span>,</span>
<span>                               lake_basin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span><span class="op">)</span>,</span>
<span>                               lake_id <span class="op">=</span> <span class="st">"lake_ID"</span>,</span>
<span>                               n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>With the delineated lake catchments and having identified the
Hydrography90m unique stream segments IDs intersecting with lakes lets
us use hydrographr R functions for additional analysis.</p>
<div class="section level4">
<h4 id="environment90m-data-integration">Environment90m data integration<a class="anchor" aria-label="anchor" href="#environment90m-data-integration"></a>
</h4>
<p>We can now integrate the Environment90m dataset [cite Environment90m
paper], which include over 50 variables related to topography, hydrology
and climate data aggregated to the subcatchment level of the
Hydrograpyh90m stream network and apply them to [see also <a href="https://hydrography.org/environment90m" class="external-link uri">https://hydrography.org/environment90m</a>] our newly
delineated lake catchments.</p>
</div>
</div>
<div class="section level3">
<h3 id="land-cover-per-lake-catchment">Land cover per lake catchment<a class="anchor" aria-label="anchor" href="#land-cover-per-lake-catchment"></a>
</h3>
<p>For instance, we can download the land cover data to create time
series representing the land cover change within a lake catchments.
Let`s look at how the percentage of rainfed cropland and decidous forest
changed during the time period 1992 to 2020 at lake Rangsdorf (HydroLAKE
ID 165245).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tile_id</span> <span class="op">&lt;-</span> <span class="st">"h18v02"</span></span>
<span><span class="fu"><a href="../reference/download_env90m_tables.html">download_landcover_tables</a></span><span class="op">(</span></span>
<span>  base_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c10"</span>, <span class="st">"c20"</span><span class="op">)</span>,</span>
<span>  years <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tile_ids <span class="op">=</span> <span class="va">tile_id</span>,</span>
<span>  download <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  download_dir <span class="op">=</span> <span class="va">wdir</span>,</span>
<span>  file_format <span class="op">=</span> <span class="st">"txt"</span>,</span>
<span>  delete_zips <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ignore_missing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tempdir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>First we identify all sub-catchments of the lake catchment using the
<code>extract_ids</code> function: Note check again visually which
basin.tif files are covered by the lake catchment, since it can span
over multiple basin tiles. In our case the lake catchment is situated
only in one tile (tile id h18v02).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_catch</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/basin_lake_165245_coord_1.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sub_catch</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/sub_catchment.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lake_catch_crop</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">sub_catch</span>, <span class="va">lake_catch</span><span class="op">)</span></span>
<span><span class="va">lake_catch_crop</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">lake_catch_crop</span>, <span class="va">lake_catch</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">lake_catch_crop</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/lake_catch_crop.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lake_catch_crop</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/lake_catch_crop.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lake_catch_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_ids.html">extract_ids</a></span><span class="op">(</span>subc_layer <span class="op">=</span> <span class="va">lake_catch_crop</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">lake_catch_ids</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">'/data/subc_IDs.txt'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we subset the Environment90m land cover data by the sub_catchment
ID and join the yearly data table to create a time series of land cover
change.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">1992</span><span class="op">:</span><span class="fl">2020</span></span>
<span><span class="va">tile_id</span> <span class="op">&lt;-</span> <span class="st">"h18v02"</span></span>
<span></span>
<span><span class="co"># Create name vectors</span></span>
<span><span class="va">c10_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"c10_"</span>, <span class="va">years</span><span class="op">)</span></span>
<span><span class="va">c20_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"c20_"</span>, <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">c10_names</span>, <span class="va">c20_names</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_predict_table.html">get_predict_table</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="va">var</span>,</span>
<span>  statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>,</span>
<span>  tile_id <span class="op">=</span> <span class="va">tile_id</span>,</span>
<span>  input_var_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/esa_cci_landcover_v2_1_1/"</span><span class="op">)</span>,</span>
<span>  subcatch_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/subc_IDs.txt"</span><span class="op">)</span>,</span>
<span>  out_file_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/predictTB.csv"</span><span class="op">)</span>,</span>
<span>  read <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">tb</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">'/data/land_cover_subc.txt'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The landcover values show the percentage covered by the different
land use categories.To show a change in land cover we will convert the
percentage in the area they cover of any given sub-catchment. For this
we will calculate the area of our sub-catchments.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_catch_crop</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/lake_catch_crop.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lakec_area</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span><span class="va">lake_catch_crop</span>, unit<span class="op">=</span><span class="st">"km"</span>, zones<span class="op">=</span><span class="va">lake_catch_crop</span><span class="op">)</span></span>
<span><span class="va">tb</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">59</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tb</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">59</span><span class="op">]</span> <span class="op">*</span> <span class="va">lakec_area</span><span class="op">$</span><span class="va">area</span></span>
<span><span class="va">col_sums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rowSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">tb</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">59</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert named vector to data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">enframe</span><span class="op">(</span><span class="va">col_sums</span>, name <span class="op">=</span> <span class="st">"id"</span>, value <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Separate 'id' into 'variable' and 'year', remove "y" prefix from year</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">id</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variable"</span>, <span class="st">"year"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_y"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Lets portrait the land cover time series within a simple histogram,
showcasing the change over time in the rainfed and irrigated crop in the
lake catchment.</p>
<p>Add histogram</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c10"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"c20"</span> <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Every 2nd year</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Land cover percentage"</span>, color <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Additionally to the environmental analysis we can look at the
position of lakes within the stream network. For instance we can
calculate the distance between the Rangsdorfer lake and the Zeuthener
lake (lake ID 165161). Do to this we first need to download vector data
of the Hydrography90m stream network and abstract it into a graph.</p>
<div class="section level4">
<h4 id="calculating-distances-between-lakes">Calculating distances between lakes<a class="anchor" aria-label="anchor" href="#calculating-distances-between-lakes"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="download-the-vector-stream-network-geopackage">Download the vector stream network geopackage<a class="anchor" aria-label="anchor" href="#download-the-vector-stream-network-geopackage"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the tif.files of the selceted variables</span></span>
<span><span class="fu"><a href="../reference/download_tiles.html">download_tiles</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"order_vect_segment"</span>,</span>
<span>               tile_id <span class="op">=</span> <span class="va">tile_id</span>,</span>
<span>               file_format <span class="op">=</span> <span class="st">"gpkg"</span>,</span>
<span>               download_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that the data is stored in a separate folder called
r.stream.order. To calculate the distance between lakes we first
represent the vector stream network in a graph.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>,</span>
<span>                                          <span class="st">"data/r.stream.order"</span>,</span>
<span>                                          <span class="st">"/order_vect_tiles20d/order_vect_segment_h18v02.gpkg"</span><span class="op">)</span>,</span>
<span>                            import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_geopackage.html">read_geopackage</a></span><span class="op">(</span>gpkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>,</span>
<span>                                          <span class="st">"/data/r.stream.order"</span>,</span>
<span>                                          <span class="st">"/order_vect_merge.gpkg"</span><span class="op">)</span>,</span>
<span>                            import_as <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span></span></code></pre></div>
<p>Now we extract the stream segment ID of the lake outlets. Between the
two lakes of interest we will calculate the distance in meter.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_165245_intersect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/coord_lake_165245.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lake_165245_intersect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lake_165161_intersect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdir</span>, <span class="st">"/data/coord_lake_165161.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lake_165161_intersect</span><span class="op">)</span></span></code></pre></div>
<p>In both tables the first row represents the lake outlet (having the
highest flow accumulation value). We can now calculate the distance
between the two outlets using the sub-catchment ID of the first row
found in the column subc_id. That are for the Rangsdorfer lake subc_id
507419535 and for the Zeuthener lake subc_id 507343759. They correspond
to the unique sub-catchment and stream segment ID of the Hydrography90m
stream network.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subc_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"507419535"</span>, <span class="st">"507343759"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">subc_distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_distance_graph.html">get_distance_graph</a></span><span class="op">(</span><span class="va">my_graph</span>,</span>
<span>                                      subc_id <span class="op">=</span> <span class="va">subc_id</span>,</span>
<span>                                      variable <span class="op">=</span> <span class="st">"length"</span>,</span>
<span>                                      distance_m <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                      <span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">subc_distances</span><span class="op">)</span></span></code></pre></div>
<p>The distance between the two lakes (from outlet to outlet) amounts to
31842.6 meter or 31.8 km.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-amatulli2022hydrography90m" class="csl-entry">
Amatulli, Giuseppe, Jaime Garcia Marquez, Tushar Sethi, Jens Kiesel,
Afroditi Grigoropoulou, Maria M Üblacker, Longzhu Q Shen, and Sami
Domisch. 2022. <span>“Hydrography90m: A New High-Resolution Global
Hydrographic Dataset.”</span> <em>Earth System Science Data</em> 14
(10): 4525–50.
</div>
<div id="ref-friedrichs2024freshwater" class="csl-entry">
Friedrichs-Manthey, Martin, Diana E Bowler, and Jörg Freyhof. 2024.
<span>“Freshwater Fish in Mid and Northern German Rivers–Long-Term
Trends and Associated Species Traits.”</span> <em>Science of the Total
Environment</em> 957: 177759.
</div>
<div id="ref-messager2016estimating" class="csl-entry">
Messager, Mathis Loı̈c, Bernhard Lehner, Günther Grill, Irena Nedeva, and
Oliver Schmitt. 2016. <span>“Estimating the Volume and Age of Water
Stored in Global Lakes Using a Geo-Statistical Approach.”</span>
<em>Nature Communications</em> 7 (1): 13603.
</div>
<div id="ref-schurz2023hydrographr" class="csl-entry">
Schürz, Marlene, Afroditi Grigoropoulou, Jaime Garcı́a Márquez, Yusdiel
Torres-Cambas, Thomas Tomiczek, Mathieu Floury, Vanessa Bremerich, et
al. 2023. <span>“Hydrographr: An r Package for Scalable Hydrographic
Data Processing.”</span> <em>Methods in Ecology and Evolution</em> 14
(12): 2953–63.
</div>
<div id="ref-soille2022morphological" class="csl-entry">
Soille, Pierre, and Peter Vogt. 2022. <span>“Morphological Spatial
Pattern Analysis: Open Source Release.”</span> <em>The International
Archives of the Photogrammetry, Remote Sensing and Spatial Information
Sciences</em> 48: 427–33.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marlene Schürz, Afroditi Grigoropoulou, Jaime Garcia Marquez, Yusdiel Torres Cambas, Christoph Schürz, Mathieu Floury, Thomas Tomiczek, Vanessa Bremerich, Merret Buurman, Giuseppe Amatulli, Sami Domisch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
