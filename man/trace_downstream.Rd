% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{trace_downstream}
\alias{trace_downstream}
\title{Trace downstream until reaching a Strahler threshold}
\usage{
trace_downstream(start_id, df, strahler_retain_threshold)
}
\arguments{
\item{start_id}{Integer. The starting subcatchment ID.}

\item{df}{A data.frame or tibble containing at least the columns
`subc_id`, `target`, and `strahler_order`.}

\item{strahler_retain_threshold}{Integer. The Strahler order at or above
which downstream tracing stops.}
}
\value{
An integer vector of subcatchment IDs traced downstream.
}
\description{
Internal helper function. Given a starting subcatchment ID, this function
follows the downstream `target` chain and collects all downstream
segments until one of the following conditions is met:

- the next segment has a Strahler order greater than or equal to
  `strahler_retain_threshold`
- a segment has no downstream `target`
- a loop is detected
}
\keyword{internal}
