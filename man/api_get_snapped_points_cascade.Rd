% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_get_snapped_points_cascade.R,
%   R/api_get_snapped_points_cascade.r
\name{api_get_snapped_points_cascade}
\alias{api_get_snapped_points_cascade}
\title{Cascade Snapping of Points to Stream Segments by Strahler Order}
\usage{
api_get_snapped_points_cascade(
  df,
  col_lat = "lat_before",
  col_lon = "lon_before",
  col_site = "site_id",
  strahler_seq = c(4, 3, 2),
  distance_threshold = 150
)

api_get_snapped_points_cascade(
  df,
  col_lat = "lat_before",
  col_lon = "lon_before",
  col_site = "site_id",
  strahler_seq = c(4, 3, 2),
  distance_threshold = 150
)
}
\arguments{
\item{df}{A data.frame containing the input point coordinates and site IDs.}

\item{col_lat}{Character string. Column name for original latitude values.}

\item{col_lon}{Character string. Column name for original longitude values.}

\item{col_site}{Character string. Column name for the unique site identifier.}

\item{strahler_seq}{Numeric vector of Strahler orders to snap to (in
descending order). Default is `c(4, 3, 2)`.}

\item{distance_threshold}{Numeric. Maximum allowed snapping distance (in
meters). Points exceeding this distance are forwarded to the next
Strahler order. Default is 150 m.}
}
\value{
A `data.frame` with:
  * input coordinates and site_id
  * snapped coordinates (`lon_after`, `lat_after`)
  * `subc_id_after`
  * `dist_to_snapped` (meters, Haversine distance)
  * `strahler` (Strahler order where snapping succeeded)

A `data.frame` with:
  * input coordinates and site_id
  * snapped coordinates (`lon_after`, `lat_after`)
  * `subc_id_after`
  * `dist_to_snapped` (meters, Haversine distance)
  * `strahler` (Strahler order where snapping succeeded)
}
\description{
Iteratively snaps points to stream segments of decreasing Strahler order.
After each snapping round, points whose snapping distance exceeds
`distance_threshold` are passed to the next (finer) Strahler level.
This "cascade snapping" approach improves snapping accuracy while preventing
points from being snapped too far away from their original location.

Iteratively snaps points to stream segments of decreasing Strahler order.
After each snapping round, points whose snapping distance exceeds
`distance_threshold` are passed to the next (finer) Strahler level.

This "cascade snapping" approach improves snapping accuracy while preventing
points from being snapped too far away from their original location.
}
\details{
This function requires the following hydrographr API helpers:
* `standardize_input()`
* `api_get_snapped_points_strahler()`

Snapping distance is computed using `geosphere::distHaversine()`.

This function requires the following hydrographr API helpers:
* `standardize_input()`
* `api_get_snapped_points_strahler()`

Snapping distance is computed using `geosphere::distHaversine()`.
}
\examples{
\dontrun{
snapped <- snap_points_cascade(
  df = pts,
  col_lat = "lat",
  col_lon = "lon",
  col_site = "id",
  strahler_seq = c(5, 4, 3),
  distance_threshold = 100
)
}

\dontrun{
snapped <- snap_points_cascade(
  df = pts,
  col_lat = "lat",
  col_lon = "lon",
  col_site = "id",
  strahler_seq = c(5, 4, 3),
  distance_threshold = 100
)
}

}
